<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>

<body>
<h1>ACCESS TOKEN</h1>
<h3 class="accessOld"></h3>
<h3 class="accessResult"></h3>

<h1>REFRESH TOKEN</h1>
<h3 class="refreshOld"></h3>
<h3 class="refreshResult"></h3>
<button class="btn1">Refresh</button>

<!--http://localhost:9050/files/refreshTest.html-->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>

const oldAccessToken = localStorage.getItem("accessToken");
const oldRefreshToken = localStorage.getItem("refreshToken");

document.querySelector(".accessOld").innerHTML = oldAccessToken;
document.querySelector(".refreshOld").innerHTML = oldRefreshToken;


    document.querySelector(".btn1").addEventListener("click", () => {


        axios.post('http://localhost:9060/refreshToken',
            {accessToken: oldAccessToken, refreshToken: oldRefreshToken})
            .then(res => {
                console.log(res.data)

                const newAccessToken = res.data.accessToken
                const newRefreshToken = res.data.refreshToken

                document.querySelector(".accessResult").innerHTML =
                    oldAccessToken !== newAccessToken?newAccessToken:'OLD'
                document.querySelector(".refreshResult").innerHTML =
                    oldRefreshToken !== newRefreshToken?newRefreshToken:'OLD'


            })
            .catch(error => {
                    // ğŸ”¥ ì—¬ê¸°ì„œ ì—ëŸ¬ JSON ì²˜ë¦¬
                    if(error.response && error.response.data) {
                        const msg = error.response.data.msg
                        alert("Refresh ì‹¤íŒ¨: " + msg)

                        if(msg === 'OLD_REFRESH' || msg === 'NO_REFRESH') {
                    /*        // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ ë“±
                            localStorage.removeItem("accessToken")
                            localStorage.removeItem("refreshToken")*/
                        }
                    }
            }
        )


    },false)

</script>

</body>
</html>